{"version":3,"file":"mobileUtils.js","sources":["../src/common/common.js","../src/dom.js","../src/main.js"],"sourcesContent":["//! 判断浏览器是否支持scroll-behavior\nexport function isSupportSmoothScroll () {\n  let isSupport = !!window.getComputedStyle(document.body).scrollBehavior\n  isSupportSmoothScroll = () => isSupport\n  return isSupport\n}\n\n//! 必须传递参数\nexport function mustParam (param) {\n  throw new Error(`${param} are required`)\n}\n","\nimport { isSupportSmoothScroll, mustParam } from './common/common.js'\n\n//! 判断两个元素之间的距离元素的顶部，以及元素的最左边\nexport function EleDistanceEle (childEle = mustParam('childEle'), parentEle = mustParam('parentEle')) {\n  if (!(childEle instanceof Element)) throw new Error(`childEle must be Element`)\n  if (!(parentEle instanceof Element)) throw new Error(`parentEle must be Element`)\n  //! 最大遍历次数(也就是DOM最大嵌套层级)\n  let mustWhileExeCount = 30\n  let initExeCount = 0\n  let isSuccess = true\n  let result = {\n    top: 0,\n    left: 0\n  }\n  while (initExeCount <= mustWhileExeCount && childEle.offsetParent && !childEle.isEqualNode(parentEle)) {\n    result.top += childEle.offsetTop\n    result.left += childEle.offsetLeft\n    childEle = childEle.offsetParent\n    initExeCount += 1\n    if (initExeCount >= mustWhileExeCount) isSuccess = false\n  }\n  if (!isSuccess) throw new Error('parentEle must be childEle parent Element or Element Level too deep')\n  return result\n}\n\n//! 带有缓动效果的滚动\nexport function easeVerticalScroll (target = mustParam('target'), scrollDOM = mustParam('scrollDOM')) {\n  if (!(target instanceof Element)) throw new Error(`target must be Element`)\n  if (!(scrollDOM instanceof Element)) throw new Error(`scrollDOM must be Element`)\n  //! 原生支持\n  if (!isSupportSmoothScroll()) {\n    target.scrollIntoView({\n      behavior: 'smooth',\n      block: 'start'\n    })\n  } else {\n    let distance = EleDistanceEle(target, scrollDOM)\n    //! TODO: 避免出问题，设置个最大滚动次数\n    let scrollCount = 30\n    let initScrollCount = 1\n    //! 是否是全局滚动\n    let isBody = scrollDOM.isEqualNode(document.body)\n    //! 滚动元素的最大滚动距离\n    let maxScroll = isBody ? scrollDOM : (scrollDOM.scrollHeight - (scrollDOM.offsetHeight || 0))\n    //! 目标距离\n    let targetPlace = distance.top > maxScroll ? maxScroll : distance.top\n    let getScrollTop = () => {\n      if (!isBody) {\n        getScrollTop = () => {\n          return scrollDOM.scrollTop || 0\n        }\n        return scrollDOM.scrollTop || 0\n      } else {\n        getScrollTop = () => {\n          return window.pageYOffset || 0\n        }\n        return window.pageYOffset || 0\n      }\n    }\n    //! 设置顶部的距离\n    let setScrollTop = (number = 0) => {\n      if (!isBody) {\n        setScrollTop = (number3) => {\n          scrollDOM.scrollTop = number3\n        }\n        scrollDOM.scrollTop = number\n      } else {\n        if (document.body && document.body.scrollTop) {\n          setScrollTop = (number1 = 0) => {\n            document.body.scrollTop = number1\n          }\n        } else if (document.documentElement && document.documentElement.scrollTop) {\n          setScrollTop = (number2) => {\n            document.documentElement.scrollTop = number2\n          }\n        }\n        document.body.scrollTop = document.documentElement.scrollTop = number\n      }\n    }\n    let timer = requestAnimationFrame(function fn () {\n      //! 当前相差多少\n      let currentDistance = parseInt(targetPlace) - getScrollTop()\n      if (Math.abs(currentDistance) <= 1 || initScrollCount >= scrollCount) {\n        setScrollTop(targetPlace)\n        cancelAnimationFrame(timer)\n        initScrollCount = 1\n      } else {\n        initScrollCount += 1\n        let shouldScroll = currentDistance * (0.25)\n        //! TODO:小于1的时候scrollTop设置了不会触发滚动\n        let shouldScrollTop = getScrollTop() + (shouldScroll < 1 ? 1 : shouldScroll)\n        setScrollTop(shouldScrollTop)\n        timer = requestAnimationFrame(fn)\n      }\n    })\n  }\n}\n","\nimport { easeVerticalScroll } from './dom.js'\nexport default {\n  //! 平滑滚动\n  easeVerticalScroll\n}\n"],"names":["isSupportSmoothScroll","isSupport","window","getComputedStyle","document","body","scrollBehavior","mustParam","param","Error","EleDistanceEle","childEle","parentEle","Element","mustWhileExeCount","initExeCount","isSuccess","result","top","left","offsetParent","isEqualNode","offsetTop","offsetLeft","easeVerticalScroll","target","scrollDOM","scrollIntoView","behavior","block","distance","scrollCount","initScrollCount","isBody","maxScroll","scrollHeight","offsetHeight","targetPlace","getScrollTop","scrollTop","pageYOffset","setScrollTop","number","number3","number1","documentElement","number2","timer","requestAnimationFrame","fn","currentDistance","parseInt","Math","abs","cancelAnimationFrame","shouldScroll","shouldScrollTop"],"mappings":"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"}